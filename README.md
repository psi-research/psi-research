# 치안분야 자연어처리 벤치마크 개발

## 최종보고서 보안등급
일반[√], 보안[ ]

## 사업명
- 사업명: 인재활용확산지원
- 내역사업명: 해외우수과학자유치사업(Brain Pool)
- 전문기관명: 한국연구재단
- 연구개발과제번호: RS-2023-00304286

## 기술분류
### 국가과학기술표준분류
- 인공지능 60%
- 프로그래밍언어/자연어 40%

### 과학기술분야분류
- 사회질서 및 안전 100%

## 연구개발과제명
- 국문: 치안분야 자연어처리 벤치마크 개발
- 영문: Development of Natural Language Processing Benchmark for Policing

## 주관연구개발기관
- 기관명: 경찰대학 산학협력단
- 사업자등록번호: 142-82-01333
- 기관유형: 국공립(연)
- 주소: (31539)충청남도 아산시 신창면 황산길 100-50 경찰대학

- ## 연구책임자
- 성명: 윤철희
- 직위: 과학기술부 연구관
- 연락처
  - 직장전화: 041-968-2017
  - 휴대전화: 010-2106-3960
  - 전자우편: bertter@police.ac.kr

## 해외우수과학자(BP Fellow)
- 성명: 김미영
- 국적: 한국
- 연락처
  - 직장전화: +1-780-679-1104
  - 전자우편: miyoung2@ualberta.ca
  - 국가연구자번호: 13024744

## 총 연구개발기간
- 2023.12.06.~2024.09.05.(9개월)

## 연구개발비(단위: 천원)
### 총계
- 정부지원연구개발비(현금): 92,004
- 기관부담연구개발비(현금): 0
- 기관부담연구개발비(현물): 0
- 합계: 92,004천원

### 1년차
- 정부지원연구개발비(현금): 92,004
- 기관부담연구개발비(현금): 0
- 기관부담연구개발비(현물): 0
- 합계: 92,004천원

## 연구개발과제 실무담당자(전담인력)
- 성명: 이서영
- 직위: 연구관
- 연락처
  - 직장전화: 041-968-2397
  - 휴대전화: 010-2246-8654
  - 전자우편: lsy8654@police.go.kr
  - 국가연구자번호: 13027919
 
  - ## 요약문

### 사업명
인재활용확산지원

### 내역사업명
해외우수과학자유치사업(Brain Pool)

### 연구개발과제번호
RS-2023-00304286

### 기술분류
#### 국가과학기술표준분류
- 인공지능 60%
- 프로그래밍언어/자연어 40%

#### 과학기술분야분류
- 사회질서 및 안전 100%

### 연구개발과제명
치안분야 자연어처리 벤치마크 개발

### 전체 연구개발기간
2023.12.06.~2024.09.05.(9개월)

### 총 연구개발비
총 92,004천원 (정부지원연구개발비:92,004천원, 기관부담연구개발비 :0천원, 그 외 지원금:0천원)

### 연구개발단계
- 기초[ ] 응용[ ] 개발[ü]
- 기타(위 3가지에 해당되지 않는 경우)[ ]

### 연구개발 목표 및 내용
#### 최종 목표
치안분야 언어모델 성능평가를 위한 치안분야 벤치마크 데이터셋 개발

#### 전체 내용
1. 언어모델이 치안분야에 적용되었을 때 성능평가를 위한 치안분야 벤치마크데이터셋 개발
   - 자연언어처리 기술을 활용한 다양한 치안분야 연구기술개발이 추진되고 있지만, 핵심요소 기술인 언어모델이 치안분야에 적용되었을 때 제대로 성능평가를 할 수 있는 치안분야 벤치마크 데이터셋이 없어 문제점 발생. 관련, 치안분야 전용 벤치마크데이터셋 개발이 필요
   - 급격하게 발전하고 있는 언어모델들이 치안분야에 적용되었을 때의 성능 편차가 매우 커서 신뢰성 있는 성능 평가를 위한 치안분야 전용 벤치마크 데이터셋 개발이 필수적

2. 벤치마크 데이터셋 개발과 함께, 치안분야 언어모델 개발
   - 바이오, 의료, 법령, 특허 등의 분야에 특화된 언어모델들이 개발되었듯이, 수사, 교통, 생활안전 등 치안 데이터 학습을 기반으로 치안분야에 특화된 언어모델을 개발이 필요

### 1년차
#### 목표
치안분야 언어모델 성능평가를 위한 치안분야 벤치마크 데이터셋 개발

#### 내용
1. 언어모델이 치안분야에 적용되었을 때 성능평가를 위한 치안분야 벤치마크데이터셋 개발
   - 보이스피싱, 치안 질의 등 전용 벤치마크 데이터셋 9종
   - 치안데이터 비식별화, 의도분류 비식별화

2. 벤치마크 데이터셋 개발과 함께, 치안분야 언어모델 개발
   - 치안 분야 데이터셋 개발 진행 후 치안 언어모델 빌드
     ➀ Poli-ELECTRA
     ➁ Poli-Mamba
     ➂ Poli-llama
     ➃ Poli-Gemma
     ➄ Poli-llama-70B

     ## 수행 과정 및 수행 내용(Major research topics and outcome)

### 1) 주요내용(Major Topic)

| 연구내용 | 연구결과 |
| 데이터 비식별화 수행 치안벤치 마크 셋 구성 | - 치안벤치 마크 셋을 위한 데이터셋 비식별화 제작 - 치안분야에 활용 가능 데이터셋 제작 (9종) : 비식별화 수행 - 치안분야에 활용 가능 데이터셋 활용 : 의도분석 레이블 수행 |
| 치안벤치 마크 셋 적용 치안언어 모델 빌드 | 치안벤치 마크 셋을 위한 치안언어 모델 빌드 - 치안분야 언어모델 빌드 : 최신 5종 이상 언어LLM 빌드 수행 |

### 데이터 비식별화 및 치안 벤치 마크 셋 구성 

#### ➀ 데이터 비식별화 수행

■ 최근 인공지능(AI) 기술, 특히 대규모 언어 모델(Large Language Models, LLMs)과 같은 생성형 AI 기술의 급속한 발전으로 다양한 산업 분야에서 AI의 활용이 증가하고 있음. 치안 분야에서도 AI 기술을 활용한 범죄 예방, 수사 지원, 긴급 대응 등의 필요성이 대두되고 있으나, 데이터의 개인정보의 문제가 대두되어 비식별화를 수행함

■ 기존의 일반적인 AI 모델들은 치안 분야의 특수성이 담긴 데이터를 반영하지 못하여, 최신 범죄 동향이나 법률 정보 등을 즉각적으로 반영하기 어려운 한계가 있어 치안 언어용 데이터 학습이 필요

- 데이터의 특수성 적용: 치안 관련 데이터는 민감하고 기밀성이 높아 일반 AI 모델의 학습에 사용하기 어려움
- 실시간 업데이트의 필요성: 범죄 수법이나 법률은 지속적으로 변화하므로, 이를 실시간으로 반영할 수 있는 유연한 시스템 필요
- 높은 정확도 요구: 치안 분야의 의사결정은 직접적으로 시민의 안전과 권리에 영향을 미치므로 매우 높은 수준의 정확도 필요
- 범죄 패턴의 복잡화 및 다양화에 따른 데이터 적용: 사이버 범죄, 국제적 범죄 조직 등 새로운 유형의 범죄에 대응하기 위한 고도화된 분석 능력 필요
- 대규모 민감 데이터 처리의 필요성: CCTV 영상, 통신 기록, SNS 데이터 등 방대한 양의 정보를 신속하고 정확하게 분석할 수 있는 기술 요구
- 인력 및 자원의 효율적 데이터 활용: 반복적이고 시간 소모적인 업무를 AI가 대체함으로써 인적 자원을 중요 업무에 집중 배치 가능

### 1) 치안 특화 AI 시스템 개발을 위한 치안 데이터 셋 수집

- 할루시네이션의 한계극복을 위한 치안 전용 언어 모델의 데이터 셋 수집
: 기술적 문제점을 극복하고자 BELUGA(Benchmark for Empowering Law enforcement Using Generative 데이터셋: 가칭) 프로젝트 수행

### 가. 치안 AI 벤치마크 데이터셋 수집
- 범죄 예방, 긴급 신고 대응, 범죄 수사 등 각 단계별 데이터 구축
- 실제 경찰 업무 데이터를 기반으로 구축하여 현장 적용성 극대화

### 나. 개인정보 보호를 위한 철저한 비식별화 처리
- 개인정보 보호를 통한 지속적인 업데이트 체계를 통해 최신 범죄 동향 반영
- 현장 데이터를 수집하여 비식별화 처리

### 2) 치안 벤치마크 데이터 셋 구현을 위한 전용 데이터 DB구현
- 인공지능 기반 수사기법 검색·추천시스템 개발에 필요한 언어 모델을 학습하기 위해, 매뉴얼·사건·법률 데이터셋 구축과 이에 따른 파인튜닝용 데이터셋 수집 처리용 DB처리

### ■ Vishing detection 데이터 제작을 위한 전사 및 비식별화 태그 수정
- 발주처에서 제공한 데이터에 대한 초벌전사 후 비식별화 태그 수정작업을 진행 
- 총14,030건의 결과물을 정리함

### ■ Vishing next utterance prediction 데이터 제작을 위한 전사 및 의도 분류 레이블링
- 치안 데이터에 대한 초벌전사 및 전사보정 후 발화 의도 분류 레이블링 작업을 진행하여 총 48,229건의 결과물을 정리함

### ■ 지식 문서 전처리
- 치안 범죄 수사 지식 관련 raw 데이터에 대하여 발주처에서 요청한 규격에 맞게 지식 문서 가공을 진행하여, 총 57건 10,235페이지 분량에 대한 결과물을 정리함
- 비식별화 태깅 작업은 1차적으로 진행한 BIO 태그 전처리 결과물을 바탕으로 태그 오류 및 내용 오류 등을 수정 및 보완하는 작업을 진행함

### 가. 전처리 가이드라인 제작
- 비식별화 태깅 작업은 BIO 태그 전처리 결과물을 바탕으로 태그 오류 및 내용 오류 등을 수정 및 보완하는 작업을 진행함
- B(Begin)와 I(Inside)를 모두 표현하기 위하여 총 18개 태그 기호가 존재

### [비식별화 태그 분류표]
| 번호 | 태그 형식-태그명 | 설명 |
| 1 | [B/I-name] | 이름(홍길동, 홍 김자 등자) |
| 2 | [B/I-age] | 나이(47세, 40대, 스물여덟살) |
| 3 | [B/I-birth] | 생년월일(83년생, 10월 30일생) |
| 4 | [B/I-bank] | 은행(농협은행, 하나은행, 카카오 뱅크) |
| 5 | [B/I-organization] | 기관/상호명(킹 엔마방, 강남 경찰서) |
| 6 | [B/I-address] | 주소(경기도 시흥시, OO로 OO번지, 동/호수) |
| 7 | [B/I-account] | 계좌 번호 |
| 8 | [B/I-phone] | 핸드폰 번호 |
| 9 | [B/I-id] | 주민 등록 번호/사업자 등록 번호 |

### 예시) 구현 처리 사례
명의도 사건으로 연락드렸습니다. → 명의도용 사건으로 연락드렸습니다.
전주 농협원의 직원이었고 → 전직 농협원의 직원이었고
내경제은행[B-bank] 맞으시죠 ? → 내 국내 은행 맞으시죠?
국민[B-organization], 사회[B-organization]면[B-organization], 위메프[B-organization] → 쇼핑

2022년 3월 16일 일대[B-address]당[B-address] 기초[I-address]몰[I-address]시[I-address] 영등포구[I-address] 물패동 지점에서 우리 은행 통장을 개설한 사실이 있습니까? 어니요 → 이매 당시

월단 대전[B-address] 중, 대전광역시, 중국[B-bank]은행[B-bank]점[B-bank]점 혹은 건 적은 없다라고 하시는 거죠 ? → 중구 은행동지점

### 나. 내용 수정 및 저장
- 비식별 태그는 제작된 작업 툴을 통해 저장, 수정할 내용이 자주 출현하는 내용으로 판단될 경우 태그 뱅크에 추가하여 앞으로 작업할 문서에서 해당 내용을 자동으로 변환하여 보여주었음 
- BIO 태깅 방법은 코퍼스(corpus)로부터 개체명을 인식하기 위한 가장 보편적인 방법으로 공백(띄어쓰기)을 기준으로 B(Begin)와 I(Inside)를 구분하여 마킹하는 기준을 선정하였으며, 예를 들어 주소 정보인 "경기도 시흥시 독산동"을 태깅 한다면 아래와 같은 결과물로 태깅하였음.

### Ⓐ account
- 계좌 번호의 경우, 번호를 3~4자리씩 묻고 답하면서 말을 따라하는 경우가 많기 때문에 발화자 유추나 띄어쓰기, 작업의 일관성 관련 표기함.

### Ⓑ name
- 한사건에 등장하는 동일 인물의 이름이 텍스트 인식의 오류로 인해 다르게 나타나는 경우가 매우 자주 발생함
- 기준의 일관성을 위해 이름 태그의 경우, 자주, 그리고 많이 출현되는 이름을 기준으로 진행함
- 피해자의 이름을 물어보는 과정에서 한 글자씩 물어보는 경우와 묻고 답하면서 따라하는 경우, 발화자 유추나 띄어쓰기, B/I 태그 등 식별이 어려운 문제가 있었음
- 따라서, 위 1)번의 예시처럼 의미있는 억양구 단위마다 B/I 태그를 진행하였고, 이름이 전체적으로 불러지지 않고 성만 사용된 경우(예: 김 부장님, 박선생님, 고사장님, 김대포님 등등) name 태그를 삭제 처리

### Ⓒ bank, organization
- 은행과 기관명, 상호명 태그는 작업 기준의 일관성을 위해 아래와 같이 표기하기로 논의함

### Ⓓ birth
- 년생, 년도생, 일생, 생 등 출생과 관련된 어미 단어도 태그에 포함

예시: 
1984[B-birth]년[B-birth] 2[I-birth]월[I-birth] 6[I-birth]일[I-birth]생입니다.
↓
1984년[B-birth] 2월[I-birth] 6일[I-birth]생입니다.

1984[B-birth]년[B-birth]생 맞습니까?
↓
1984년생[B-birth] 맞습니까?

### Ⓔ age
- 세, 대, 살 등 나이와 관련된 어미 단어도 태그에 포함

예시:
40[B-age]대 남성 → 40대[B-age] 남성
39[B-age]세 → 39세[B-age]
스물여덟[B-age]살 → 스물여덟살[B-age]

### 다. 작업 툴 제작
- 비식별화 태깅 작업을 수월하게 진행하기 위하여 별도의 전용 GUI 툴을 제작하였으며 총 18건의 BIO 레이블을 쉽게 등록 및 수정, 삭제가 가능함

### 라. 후처리

#### Ⓐ 태그 미수정 및 미 작업 오류 확인 및 검증
- 비식별화 작업자가 미처 작업하지 못한 파일에서 아래와 같은 형태의 오류가 나타나는지 확인하는 과정
- 검출 방식은 비식별화 태그 기호인 "]" 과 "[" 사이에 텍스트가 존재하는지, 공백이 있는지로 판단

#### Ⓑ 태그 기호 검증
- 태그 기호에는 "-", "[", "]" 과 같은 특수 기호들이 사용

#### Ⓒ 태그 미수정 및 미 작업 오류 확인 및 검증
- 비식별화 태그에는 항상 "B" 혹은 "I"가 등장하므로 해당 내용이 유효한지 검증하는 코드를 작성
- "B"와 "I" 태그간의 혼동으로 인해 발생되는 오류를 발견하기 위해서 별도의 알고리즘을 제작
- B/I 태그들 간에 태그의 종류가 동일한 종류인지도 검증
- 예를 들어, 앞에 태그 내용은 "홍길동[B-name]" 이었는데, 뒤의 태그 내용은 "94년생[I-birth]"인 경우, B/I 태그의 종류가 다르므로 이를 검수자에게 알려줄 수 있도록 제작함

#### Ⓓ 개인 정보 내용 검출 및 태그 부착
- 태그가 달려 있지 않아도 개인정보로 판단 될 경우 발주처와 논의 하여 "[B-id]" 태그를 작성, 검출 키워드는 "주민등록, 주민번호, 민번, 앞자리, 뒷자리, 앞번호, 뒷번호, 6자리, 7자리"등

#### Ⓔ 각 태그별 내용 검증
- B/I 태그의 내용을 모두 모아서 태그 형태별로 정렬을 진행한 다음 육안으로 태그의 내용을 확인하는 검증 과정을 진행
- 아래 그림에서는 "[B-bank]"(은행명)으로 조회한 각 태그의 내용을 보여줌

### 수정 전/후 예시:

| 수정 전 | 수정 후 |
| 정희[B-name]외[B-name] | 정희외[B-name] |
| 정희[B-name]연[B-name] | 정희연[B-name] |
| 정희[B-name]린[B-name] | 정희린[B-name] |
| 정희[B-name]룬[B-name] | 정희룬[B-name] |
| 제1[B-bank]운행[B-bank] | 제일은행[B-bank] |
| 제[B-bank]은행[B-bank] | 제일은행[B-bank] |
| 저[B-bank]죽은행[B-bank] | 저축은행[B-bank] |
| 제[B-organization]1[B-organization]캐피털[B-organization] | 제일캐피털[B-organization] |
| 제니[B-organization]스 | 제니스[B-organization] |
| 제이[B-bank]티[B-bank] | 제이티[B-bank] |
| 제이[B-organization]비[B-organization] | 제이비[B-organization] |
| 제이[B-organization]비[B-organization]우리[B-organization] 캐피탈 | 제이비우리캐피털[B-organization] |
| 제이[B-organization]스핀[B-organization] | 제이스핀[B-organization] |
| 제이[B-organization]유[B-organization] | 제이유[B-organization] |
| 제이[B-bank] 저축은행[I-bank] | 제이저축은행[B-bank] |
| 제이티[B-bank] 저축은행[I-bank] | 제이티저축은행[B-bank] |
| 제이티[B-bank]진해[B-bank]저축은행[I-bank] | 제이티진해저축은행[B-bank] |
| 제이티[B-bank]친[B-organization] | 제이티친[B-bank] |

## 2. 수행 과정 및 수행 내용(Major research topics and outcome)

### ① 치안벤치 마크 대규모언어모델(LLM) 기술 활용도 파악
- 치안코퍼스를 활용하여 치안언어 모델 빌드 타당성 조사

### ChatGPT 이후, 대규모 언어모델(LLM)을 경쟁적으로 출시

- 언어 생성 모델 생성형 AI 기술 중 하나인 대규모 언어모델(Large Language Model, LLM)은 일반적으로 수백억 개 이상의 파라미터를 포함하는 인공지능 모델을 의미하며 복잡한 언어 패턴과 의미를 학습하고 다양한 추론 작업에 대해 우수한 성능을 보유

- 특징:
 - 초거대 언어 모델은 미리 입력된 답변을 제공하는 데서 벗어나, 스스로 생각하고 학습, 판단할 수 있도록 설계
 - AI가 맥락을 파악해 능동적으로 대화 가능
 - GPT3 이후 개발된 대표적인 초거대 AI 언어 모델로는 구글의 PaLM, LaMDA, FLAN, 메타의 opt, 엔비디아의 Megatron, 네이버의 HyperCLOVA, 빅사이언스의 BLOOM, 화웨이의 Pan-Gu 등이 있음

### 주요 모델:
- ChatGPT-4 (오픈AI)
- Gemini Pro 1.5 (구글)
- ChatGPT-3.5 (오픈AI)
- Llama 3 (메타)
- Claude 3 (앤트로픽)

3LLM의 크기가 지속적으로 증가하고 있으며, GPT-3의 1,750억 개 파라미터에서 시작해 더 큰 규모의 모델들이 등장했으며, BERT(Poli-ELECTRA)와 같은 초기 모델들(3억 개 파라미터)에 비해 현대 LLM들의 규모가 훨씬 크다는 것을 보여 주고 있으며, AI 언어모델 기술의 빠른 발전 속도와 주요 기업들 간의 치열한 경쟁 상황을 잘 보여주고 있음

### [그림] 언어모델 유형
출처 "Attention Is All You Need" (2017) 논문에서 제안된 원래의 Transformer 구조

- Encoder-only 모델들: BERT, RoBERTa, ELECTRA 등
- Encoder-Decoder 모델들: T5, BART 등
- Decoder-only 모델들: GPT 시리즈, OPT, BLOOM 등

### ② 치안벤치 마크 LLM 모델 빌드
- 치안벤치마크 대규모언어모델(LLM) 언어모델 빌드

#### ⓐ Poli-ELECTRA
- Google의 ELECTRA 구조를 기반으로 한 모델로, 1.1억 및 3.3억 파라미터 버전 개발
- Transformer 아키텍처를 사용하며, Horovod를 통한 멀티-GPU 학습을 구현함

#### ⓑ Poli-Mamba
- 카네기 멜론 대학의 Mamba 구조를 채택한 7.9억 파라미터 규모의 모델
- State Space Model (SSM)을 기반으로 하며, DeepSpeed를 활용한 분산 학습을 수행함

#### ⓒ Poli-llama
- Meta의 Llama 3를 기반으로 한 80억 파라미터 규모의 모델
- Transformer 구조를 사용하며, DeepSpeed를 통한 효율적인 학습을 구현
- 기존 모델을 기반으로 추가 학습을 진행함

#### ⓓ Poli-Gemma
- Google의 Gemma 모델을 기반으로 한 90억 파라미터 규모의 모델
- Transformer 구조를 사용하며, DeepSpeed를 활용하여 학습을 진행함

#### ⓔ Poli-llama-70B
- Meta의 Llama 3.1을 기반으로 한 대규모 모델로, 700억 파라미터를 보유
- 단일 GPU와 경량화 기법을 활용하여 효율적인 학습 및 추론을 구현함

모든 모델은 NVIDIA의 고성능 GPU (A100 또는 H100)를 사용하여 학습되었으며, 치안 분야의 특수성을 반영하기 위해 관련 데이터로 추가 학습을 진행함
